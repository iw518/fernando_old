{% extends "project_home.html" %}
{% block css %}
    {{super()}}
{% endblock %}
{% block main %}
<div class="col-sm-10 col-sm-offset-1">
    <div class="btn-toolbar" role="toolbar">
        <div class="btn-group">
            <button type="button" class="btn btn-primary" id='print'><span class="glyphicon glyphicon-print"></span>&nbsp;&nbsp;打印</button>
            <!-- 按钮触发模态框 -->
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal" id="modal_btn"><span class="fa fa-trash-o fa-lg"></span>&nbsp;&nbsp;删除</button>
            <!-- 模态框（Modal） -->
        </div>
        <div class="btn-group">
            <button type="button" class="btn btn-primary" id='setting_btn'><span class="glyphicon glyphicon-cog"></span>&nbsp;&nbsp;设置</button>
            <button type="button" class="btn btn-primary" id='loadfsfp_btn' disabled="disabled"><span class="glyphicon glyphicon-cog"></span>&nbsp;&nbsp;加载数据</button>
            <a id="gen_txt"><button type="button" class="btn btn-primary" id='gen_btn'><span class="glyphicon glyphicon-cog"></span>&nbsp;&nbsp;生成数据</button></a>            
        </div>
    </div>
    <div>
        <select name="layerNo" id="layerNo">
        {% for item in layer_hole_ps_list %}
        <option>{{item[0]}}</option>
        {% endfor %}
        </select>
    </div>
</div>

<div id="printArea" class="col-sm-10 col-sm-offset-1">
    <div>
        <h4 style="text-align: center;"><strong>静力触探指标分析</strong></h4>
        <p>工程编号：{{projectNo}}</p>
        <hr/>
    </div>
    <div  class="col-sm-6" id="diagramDiv"></div>
</div>
{% endblock %}
{% block script%}
    {{super()}}
<script type="text/javascript" src="{{url_for('static',filename='js/analysis.js')}}"></script>
<script type="text/javascript">
    var svg=new SvgContainer("diagramDiv");
    svg.creatAxis("Ps(MPa)");
    $('#layerNo').change(function(){
        svg.show({{layer_hole_ps_list|safe}},'MPa',600,300);
    });
$(function(){
    $('#gen_btn').click(function(){
        var myurl="{{url_for('analysis.cptAnalysis',projectNo=projectNo)}}";
        var mydata={};  
        var callback_function=function(dict){$("#gen_txt").attr("href",dict['result']);
                                             $("#gen_txt").get(0).click();
                                            }
        $.ajax({
            url:myurl,
            data:mydata,
            type:"POST",
            dataType:"json",
            success:callback_function
        });
    });
});

</script>
{%endblock%}